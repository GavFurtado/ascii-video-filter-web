<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>View Processed Video</title>
  <link href="style.css" rel="stylesheet">
</head>
<body>
  <div class="video-wrapper">
    <h1 class="text-3xl font-bold text-gray-800 mb-6">Processed Video Preview</h1>
    <div id="video-container" class="flex justify-center items-center h-64 bg-gray-100 rounded-lg">
      <!-- Loading Overlay -->
      <div id="loading-overlay" class="loading-overlay">
        <div class="spinner"></div>
        <p class="loading-text">Loading video...</p>
      </div>
      <!-- Video element will be appended here by JS -->
    </div>
    
    <div class="video-info">
      <p id="video-name"></p>
      <div class="video-actions">
        <a id="download-link" href="#" download class="download-btn">Download Video</a>
        <button onclick="history.back()" class="back-btn">‚Üê Back</button>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const params = new URLSearchParams(window.location.search);
      const videoName = params.get('video');

      if (!videoName) {
        document.getElementById('video-container').innerHTML = 
          '<p style="color: #ef4444;">No video specified in URL</p>';
        return;
      }

      const container = document.getElementById('video-container');
      const loadingOverlay = document.getElementById('loading-overlay');
      const videoNameElement = document.getElementById('video-name');
      const downloadLink = document.getElementById('download-link');

      // Set video name and download link
      videoNameElement.textContent = `File: ${videoName}`;
      downloadLink.href = `./processed/${videoName}`;
      downloadLink.download = videoName;

      // Create video element
      const video = document.createElement('video');
      video.controls = true;
      video.autoplay = false;
      video.loop = false;
      video.muted = false;
      video.style.display = 'none';

      // Set video source
      const videoPath = `./processed/${videoName}`;
      video.src = videoPath;

      // Fallback for browsers that don't support the video tag
      video.innerHTML = 'Your browser does not support the video tag.';

      // Append video to container
      container.appendChild(video);

      // Hide loading overlay and show video when it can play
      video.addEventListener('canplaythrough', () => {
        console.log('Video loaded successfully');
        loadingOverlay.classList.add('hidden');
        video.style.display = 'block';
      });

      // Handle video load errors
      video.addEventListener('error', (e) => {
        console.error('Video loading error:', e);
        loadingOverlay.innerHTML = '<p style="color: #ef4444;">Error loading video</p>';
      });

      // Start loading the video
      video.load();
    });
  </script>
</body>
</html>
